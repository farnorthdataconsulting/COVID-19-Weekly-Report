---
title: "![](C:/Users/ccross/Documents/Projects/COVID-19 Weekly Report R Markdown/logo.jpg)"
author: Alaska Department of Health and Social Services Weekly COVID-19 and Influenva
  Update
date: "March 27 – April 2, 2022"
output:
  pdf_document:
    toc: no
    latex_engine: xelatex
  word_document:
    toc: yes
  html_document:
    toc: yes
    toc_float: yes
graphics: yes
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r import libraries, include = FALSE}
library(dplyr)
library(reactable)
library(htmltools)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(reactablefmtr)
library(RcppRoll)
library(Dict)
library(tinytex)
library(timetk)
```


```{r, Process Data for Onset Cases Over Time Graph, include = FALSE}

#PULL DATA FROM AGOL AND PROCESS DATA

#Pull Data from Cases Data G Hosted on AGOL
agol_cdg_csv = 'https://www.arcgis.com/sharing/rest/content/items/41be1048137a48c992daef8c321f91c0/data'
agol_cdg = read.csv(agol_cdg_csv)


#Fix Prince of Whales Name
if ("Prince Of Wales-Hyder Census Area" %in% agol_cdg$Borough){
  agol_cdg["Borough"][agol_cdg["Borough"] == "Prince Of Wales-Hyder Census Area"] <- "Prince of Wales-Hyder Census Area"
}



#Filter by Residents Only
cases_onset_residents <- filter(agol_cdg,
                    Resident..Y.N. == "Y")


#Pull Only Needed Fields
cases_onset_pull_fields <- select(cases_onset_residents, Date, Cases..Date.Onset.)



#Group All Onset Counts by Date for Statewide Case Counts
cases_onset_group_by_date <- cases_onset_pull_fields %>% 
  group_by(Date) %>%
  summarize(Cases_Date_Onset = sum(Cases..Date.Onset.))

cases_onset_group_by_date$Date <- as.Date(cases_onset_group_by_date$Date, "%m/%d/%Y") 


#Aggregate by Week Starting on Saturday
cases_onset_agg_week <- summarise_by_time(
                            cases_onset_group_by_date,
                            .date_var = Date,
                            .by = "week",
                            Cases_Date_Onset = sum(Cases_Date_Onset)
                          )


#Limit Dataset to Past 6 Months
cases_onset_filter_dates <- filter(cases_onset_agg_week, Date >= max(Date)-182)



#Set Final Dataframe
cases_onset_by_week <- data.frame(cases_onset_filter_dates)
```




```{r Process Data for Case Rates by BCA Table , include = FALSE}

#PULL DATA FROM AGOL AND PROCESS DATA

#Bring in Cases Data from AGOL
agol_cdg_csv = 'https://www.arcgis.com/sharing/rest/content/items/41be1048137a48c992daef8c321f91c0/data'
agol_cdg = read.csv(agol_cdg_csv)


#Fix Prince of Whales Name
if ("Prince Of Wales-Hyder Census Area" %in% agol_cdg$Borough){
  agol_cdg["Borough"][agol_cdg["Borough"] == "Prince Of Wales-Hyder Census Area"] <- "Prince of Wales-Hyder Census Area"
}


#Keep Only Cases by Report Date
case_rate_report_date <- select(agol_cdg,
                        Date,
                        Resident..Y.N.,
                        Occurrence..Y.N.,
                        Borough,
                        Cases..Date.Reported.)


#Filter for Residents Only
case_rate_residents <- filter(case_rate_report_date,
                    Resident..Y.N. == "Y")


#Group by Date and Borough
case_rate_date_borough <- data.frame(case_rate_residents)
case_rate_date_borough$Date <- as.Date(case_rate_date_borough$Date, "%m/%d/%Y")

case_rate_date_borough <- case_rate_date_borough %>%
  group_by(Date, Borough) %>%
  summarize(Cases = sum(Cases..Date.Reported.)) %>%
  arrange(Borough)


#Create Alaska Variable and 
case_rate_alaska_add <- case_rate_date_borough %>%
  group_by(Date) %>%
  summarize(Cases = sum(Cases)) %>%
  mutate(Borough = 'Alaska') %>%
  select(Date, Borough, Cases)


#Combine Alaska and Boroughs Dataframes
case_rate_ak_bor_combined <- rbind(case_rate_alaska_add, case_rate_date_borough)


#Create Dates Dataframe
case_rate_dates_pull <- data.frame(case_rate_ak_bor_combined)
case_rate_date_min <- min(case_rate_dates_pull$Date)
case_rate_date_max <- max(case_rate_dates_pull$Date)
case_rate_date_list = seq(from = case_rate_date_min, to = case_rate_date_max, by = "day")
case_rate_date_dataframe = data.frame(Date = case_rate_date_list)


#Create Borough List from Cases Dataframe
case_rate_borough_list <- case_rate_ak_bor_combined$Borough
case_rate_borough_list <- case_rate_borough_list[!duplicated(case_rate_borough_list)]
case_rate_borough_list <- case_rate_borough_list[case_rate_borough_list != "Unknown"]


#Run Loop and Create Date Dataframe for each Borough and Combine to Overall Dataset
case_rate_dates_bor_dataframe <- data.frame()

for (borough in case_rate_borough_list){
  case_rate_dates_merged_bor <- data.frame(case_rate_date_dataframe)
  case_rate_dates_merged_bor["Borough"] = borough
  
  case_rate_dates_bor_dataframe <- rbind(case_rate_dates_bor_dataframe, case_rate_dates_merged_bor)
}


#Merge Existing Cases Data to Dates Dataframe and Set NAs to 0
case_rate_merged_cases_to_date_bor <- left_join(case_rate_dates_bor_dataframe, case_rate_ak_bor_combined, by = c("Date" = "Date", "Borough" = "Borough"))
case_rate_merged_cases_to_date_bor[is.na(case_rate_merged_cases_to_date_bor)] <- 0


#Bring in Population Data Table from AGOL and Merge to Dataframe
agol_ak_pop_csv = "https://www.arcgis.com/sharing/rest/content/items/a898e500714c42c58d350707d2535ef4/data"
ak_pop <- read.csv(agol_ak_pop_csv)
case_rate_merged_cases_pop <- left_join(case_rate_merged_cases_to_date_bor, ak_pop, by = c("Borough" = "Area"))


#Create Cases Over the Last 7 Days and 7 Day Case Rates for Each Borough and Combine back to Dataframe
case_rate_create_cases_last_7_and_rate <- data.frame()

case_rate_cases_7_days_pull <- data.frame(case_rate_merged_cases_pop)
for (borough in case_rate_borough_list){
  case_rate_borough_pull <- case_rate_cases_7_days_pull[case_rate_cases_7_days_pull$Borough == borough,]
  case_rate_borough_pull <- case_rate_borough_pull %>%
    mutate(Cases_Last_7_Days = roll_sum(Cases, 7, align = "right", fill = NA)) %>%
    mutate(Rate_Last_7_Days = (Cases_Last_7_Days / Borough.Population) * 100000) %>%
    select(-c(Borough.Population))
  
  case_rate_create_cases_last_7_and_rate <- rbind(case_rate_create_cases_last_7_and_rate, case_rate_borough_pull)
}


#Select Data Up to Most Recent Saturday
case_rate_add_weekdays <- mutate(case_rate_create_cases_last_7_and_rate, Weekday = weekdays(Date))
case_rate_find_most_recent_sat <- case_rate_add_weekdays %>%
  filter(Weekday == "Saturday")
case_rate_most_recent_saturday <- max(case_rate_find_most_recent_sat$Date)

case_rate_fitler_back_to_most_recent_sat <- case_rate_create_cases_last_7_and_rate %>%
  filter(Date <= case_rate_most_recent_saturday)

#Remove Unknown
case_rate_remove_unk <- case_rate_fitler_back_to_most_recent_sat %>%
  filter(Borough != "Unknown")

#Set Final Data Table
case_rate_processed_cases_data <- data.frame(case_rate_remove_unk)







#CREATE CASES OVER TIME DATA TABLE

#Pull in Processed Cases Data
case_rate_cases_data_pull <- data.frame(case_rate_processed_cases_data)


#Keep Only Cases
case_rate_keep_cases <- select(case_rate_cases_data_pull, Date, Borough, Cases)


#Group by Borough and Summarize by Cases to find Total Count
case_rate_case_counts <- case_rate_keep_cases %>%
  group_by(Borough) %>%
  summarize(Cases = sum(Cases))
  

#Join Most Recent 7 Day Case Count and Rate from Processed Cases Table
case_rate_most_recent_cases_and_rate <- case_rate_cases_data_pull %>%
  filter(Date == max(case_rate_cases_data_pull$Date)) %>%
  select(-c(Cases))

case_rate_cases_merged_last_7_and_rate <- left_join(case_rate_case_counts, case_rate_most_recent_cases_and_rate, by = c("Borough" = "Borough"))


#Add Community Rate Level Tag
case_rate_cases_add_comm_rate_tag <- data.frame(case_rate_cases_merged_last_7_and_rate)

case_rate_cases_add_comm_rate_tag$Community_Rate_Tag <- ifelse(case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days >= 400, '>400',
                                              ifelse(case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days < 400 & case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days >= 200, "200-399",
                                              ifelse(case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days < 200 & case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days >= 100, "100-199",
                                              ifelse(case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days < 100 & case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days >= 50, "50-99",
                                              ifelse(case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days < 50 & case_rate_cases_add_comm_rate_tag$Rate_Last_7_Days >= 0, "0-49", 
                                              "None")))))


#Limit Decimals to 2 in Rates
case_rate_round_rates_decimals <- data.frame(case_rate_cases_add_comm_rate_tag)
case_rate_round_rates_decimals$Rate_Last_7_Days <- round(case_rate_round_rates_decimals$Rate_Last_7_Days, 2)


#Convert Rates to Strings
case_rate_convert_rates_to_strings <- data.frame(case_rate_round_rates_decimals)
case_rate_convert_rates_to_strings$Rate_Last_7_Days <- as.character(case_rate_convert_rates_to_strings$Rate_Last_7_Days)


#If Cases Less than 6, Hide Case Rate
case_rate_hide_case_rates <- data.frame(case_rate_convert_rates_to_strings)
case_rate_hide_case_rates$Rate_Last_7_Days <- ifelse(case_rate_hide_case_rates$Cases_Last_7_Days < 6, "**", case_rate_hide_case_rates$Rate_Last_7_Days)

  
#Add Commas to Case Counts and Rates
case_rate_add_thousand_commas <- data.frame(case_rate_hide_case_rates)
case_rate_add_thousand_commas$Cases_Last_7_Days <- prettyNum(case_rate_add_thousand_commas$Cases_Last_7_Days, big.mark=",")
case_rate_add_thousand_commas$Rate_Last_7_Days <- prettyNum(case_rate_add_thousand_commas$Rate_Last_7_Days, big.mark=",")


#Set Final Data Table
case_rate_cases_summary <- data.frame(case_rate_add_thousand_commas)


#Pull in Processed Cases Data
case_rate_cases_data_pull <- data.frame(case_rate_processed_cases_data)


#Keep Only Case Rates and Cases Last 7
case_rate_keep_case_rates <- select(case_rate_cases_data_pull, Date, Borough, Rate_Last_7_Days, Cases_Last_7_Days)


#Create Weekdays 
case_rate_rates_create_weekdays <- data.frame(case_rate_keep_case_rates)
case_rate_rates_create_weekdays$Weekday <- weekdays(case_rate_rates_create_weekdays$Date)


#Select Only Saturdays from DataFrame
case_rate_rates_keep_sat <- filter(case_rate_rates_create_weekdays, case_rate_rates_create_weekdays$Weekday == "Saturday")
case_rate_rates_keep_sat <- select(case_rate_rates_keep_sat, -c(Weekday))


#Keep Only Last 6 Entries for Each Borough
case_rate_last_6_entries_case_rates <- data.frame()

for (borough in case_rate_borough_list){
  case_rate_rates_borough_pull <- filter(case_rate_rates_keep_sat, Borough == borough)
  case_rate_keep_last_6 <- tail(case_rate_rates_borough_pull, n = 6)
  
  case_rate_last_6_entries_case_rates <- rbind(case_rate_last_6_entries_case_rates, case_rate_keep_last_6)
}


#Add Community Rate Level Tag
case_rate_rates_add_comm_rate_tag <- data.frame(case_rate_last_6_entries_case_rates)

case_rate_rates_add_comm_rate_tag$Community_Rate_Tag <- ifelse(case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days >= 400, 'level_5',
                                              ifelse(case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days < 400 & case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days >= 200, "level_4",
                                              ifelse(case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days < 200 & case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days >= 100, "level_3",
                                              ifelse(case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days < 100 & case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days >= 50, "level_2",
                                              ifelse(case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days < 50 & case_rate_rates_add_comm_rate_tag$Rate_Last_7_Days >= 0, "level_1", 
                                              "None")))))


#Set Final Data Table
case_rate_case_rates_over_6_weeks <- data.frame(case_rate_rates_add_comm_rate_tag)








#SET TIMESTAMPS FOR HEADER TITLES

#Pull Date Frame from Case Rates Overt Time Dataframe
case_rate_cases_time_pull <- select(case_rate_case_rates_over_6_weeks, Date, Borough) %>%
  filter(Borough == "Alaska") %>%
  select(Date)


#Set Extra Day on Start Dates to Match Sunday
case_rate_cases_start <- case_rate_cases_time_pull[5,1] + 1

case_rate_rate_start <- case_rate_cases_time_pull[1,1] + 1


#Pull the Timeframe for the Cases Over Last 7 Days
case_rate_cases_timeframe <- paste0(format(as.Date(case_rate_cases_start, format = "%Y%m%d"), "%b %d"), 
                          " - ", 
                          format(as.Date(case_rate_cases_time_pull[6,1], format = "%Y%m%d"), "%b %d"))


#Pull the Timeframe for the Case Rates Bar Graph
case_rate_rates_timeframe <- paste0(format(as.Date(case_rate_rate_start, format = "%Y%m%d"), "%b %d"), 
                          " - ", 
                          format(as.Date(case_rate_cases_time_pull[6,1], format = "%Y%m%d"), "%b %d"))








#CREATE BAR CHART IMAGES FOR TABLE

#Set an Empty List to Store Bar Graph File Locations
case_rate_temp_file_dict <- dict(init_keys = NULL, init_values = NULL)


#Set Dataframe for the Bar Charts
case_rate_bar_charts <- data.frame(case_rate_case_rates_over_6_weeks)


#Set Color Keys for Levels
level_5 = "#a8171c"
level_4 = "#df342d"
level_3 = "#fb6f50"
level_2 = "#fcb194"
level_1 = "#fee6da"


#Set Color Palette For Community Rates Bar Charts
color_palette <- c(
  "level_1" = level_1,
  "level_2" = level_2,
  "level_3" = level_3,
  "level_4" = level_4,
  "level_5" = level_5
)


#Generate Bar Graphs for Each Borough and Save to TempDir for Later Use
for (borough in case_rate_borough_list){
  
  #Pull Data by Borough
  case_rate_bar_graphs_bor_pull <- case_rate_bar_charts[case_rate_bar_charts$Borough == borough,]
  
  
  par(mar=c(1, 1, 1, 1))
  
  
  #Generate Bar Graph
  rate_plot <- ggplot(case_rate_bar_graphs_bor_pull) +
    geom_bar(aes(x=Date, y = Cases_Last_7_Days, fill = Community_Rate_Tag), width = 5, show.legend = FALSE, stat = 'identity') +
    scale_fill_manual(values = color_palette) + 
    theme(
      panel.background = element_rect(fill='transparent'),
      plot.background = element_rect(fill='transparent', color=NA),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      axis.title=element_blank(),
      axis.text=element_blank(),
      axis.ticks=element_blank(),
      legend.background = element_rect(fill='transparent'),
      legend.box.background = element_rect(fill='transparent'),
      plot.margin = unit(c(-15, -5, -20, -5), "pt")
    )
  
  
  #Set File Path to Temporary Folder
  case_rate_temp_filepath <- file.path(tempdir(), paste0(borough, " Bar Chart.png"))
  
  
  #Add Temp Filepath to Dictionary
  case_rate_temp_file_dict[borough] <- case_rate_temp_filepath
  
  
  #Export Bar Graph and Save to Temp File Location
   ggsave(path = file.path(tempdir()),
          filename = paste0(borough, " Bar Chart.png"),
          dpi= 500)
}

```




```{r, Process Data for Hospital Capacity Graph, include = FALSE}

#Pull Hospital Data Table A from AGOL
agol_hda_csv = "https://www.arcgis.com/sharing/rest/content/items/47554fa6f8e147d9b05f5c990ba630f6/data"
hosp_bed_data_pull = read.csv(agol_hda_csv)



#Filter by GCAF
hosp_bed_filter_gcaf <- filter(hosp_bed_data_pull,
                               Facility.Filter == 1)



#Select Region and Counts Columns
hosp_bed_select_cols <- select(hosp_bed_filter_gcaf,
                               Survey.Date, Hospital.Region, Pos.COVID..Imputed.)



#Create List of Regions in Data Table



#Merge Hospital Data by Region to DataFrame



#Convert Dates to Weekdays


#Keep Only Saturdays


#Drop Weekdays Column



#Set Final DataFrame

```




```{r, Proccess Data for Vaccinated Vs Unvcaccinated Bar Graphs Past 6 Weeks, include = FALSE}
```




```{r, Proccess Data for Vaccinated Vs Unvcaccinated Line Charts Past 38 Weeks, include = FALSE}
```





<p>&nbsp;</p>
<p>&nbsp;</p>




### Key Findings 

* The incidence of COVID-19 remained as high or higher than it was before the Omicron wave across most parts of Alaska during the week of March 20–March 26, 2022, with mixed   trajectories across boroughs and census areas. Case counts are no longer decreasing.

* Appreciable levels of influenza transmission began occurring in mid-December but slowly declined over the last several weeks.

* Other respiratory viruses are circulating in addition to SARS-CoV-2 and influenza virus.

* Beginning April 6, 2022, DHSS will be updating data on the Alaska COVID-19 Information Hub once a week, on Wednesdays, rather than the current three times weekly. 





<p>&nbsp;</p>
<p>&nbsp;</p>


## COVID-19 

### COVID-19 Case Trends

* COVID-19 transmission continues to occur widely throughout much of Alaska, with some evidence for an upwards trajectory. Cases and hospitalizations remain far below the peak of the Omicron wave.

* 2,461 cases were reported in Alaskans the week of March 6–March 12, however this includes a large number of older cases with delayed reporting, and the week-over-week increase in reported cases is not indicative of the true trend. The number of new cases statewide last week was similar to the number the week before.

* The number of reported COVID-19 cases last week was lower in all five of the largest boroughs (Municipality of Anchorage, Matanuska-Susitna Borough, Fairbanks North Star Borough, Kenai Peninsula Borough, and the City and Borough of Juneau) compared to the previous week, though the declines were generally more modest than those observed in previous weeks.

* The intensity of COVID-19 transmission varies between communities outside the largest boroughs. Trajectories are mixed, with COVID-19 cases declining in many boroughs and census areas but increasing in others. Regardless, absolute levels of transmission remain high in many areas.

* The Omicron variant accounts for effectively all SARS-CoV-2 circulating in Alaska. An increasing proportion of COVID-19 cases in Alaska are caused by the BA.2 lineage (a sub-type of Omicron). Visit Alaska’s SARS-CoV-2 Genomics Dashboard to learn more.

* To learn more about COVID-19 cases, hospitalizations, and deaths due to COVID-19 in Alaska, visit the Cases Dashboard or the monthly report. The cases dashboard includes demographic information on cases and the monthly report includes demographic information on hospitalizations and deaths.


<p>&nbsp;</p>
<p>&nbsp;</p>


```{r, Onset Cases by Week Graph, Include = TRUE, Echo = FALSE}

```


<p>&nbsp;</p>
<p>&nbsp;</p>



<center>
``` {r Generate Table, include = TRUE, echo = FALSE, fig.align = 'center' }

#Set Table Feature Options
options(reactable.theme = reactableTheme(
  backgroundColor = '#fffff',
  borderColor = "hsl(233, 9%, 22%)",
  stripedColor = '#e6e6e6',
))



#Set Cases Summary and Add Columsn for Reactable Table
cases_reactable_table <- data.frame(case_rate_cases_summary) %>%
  mutate(Case_Trend = NA) %>%
  select(-c(Date, Cases)) %>%
  select(Borough, Community_Rate_Tag, Rate_Last_7_Days, Cases_Last_7_Days, , Case_Trend)




#Create Tag Dictionary for Color Coding Case Rate Tags
rate_tag_dict <- dict(init_keys = NULL, init_values = NULL)
rate_tag_dict[">400"] <- 'level_5'
rate_tag_dict["200-399"] <- 'level_4'
rate_tag_dict["100-199"] <- 'level_3'
rate_tag_dict["50-99"] <- 'level_2'
rate_tag_dict["0-49"] <- 'level_1'




#Generate Final Table with Reactable
reactable(cases_reactable_table,
          defaultPageSize = 50,
          fullWidth = FALSE,
          striped = TRUE,
          borderless = FALSE,
          columns = list(
            Borough = colDef(name = "Borough/Census Area", 
                          minWidth = 260,
                          cell = function(value) {
                             class <- 'area_varela'
                             div(class = class, value)
                          }),
            
            Community_Rate_Tag = colDef(name = 'Community Case Rate',
                           align = 'center',
                           show = FALSE,
                           minWidth = 100,
                           cell = function(value) {
                             class <- paste0("tag rate_", rate_tag_dict[value])
                             div(class = class, value)
                           }),
            
            Cases_Last_7_Days = colDef(#name = "Case Count",
                                  html = TRUE,
                                  header = function(value) {
                                    value = paste0("Case Count ", cases_timeframe)
                                    div(value)
                                  },
                                  minWidth = 120,
                                  align = 'center',
                                  cell = function(value){
                                   div(class = 'number_varela', value)
                                 }
                                  ),
            
            Rate_Last_7_Days = colDef(name = "Case Rate Per 100K", 
                                 minWidth = 140,
                                 align = 'center',
                                 format = colFormat(separators = TRUE),
                                 cell = function(value, index){
                                   level <- cases_reactable_table$Community_Rate_Tag[index]
                                   class <- paste0("tag rate_", rate_tag_dict[level])
                                   div(class = class, value)
                                 }
                                 ),
            
            
            Case_Trend = colDef(#name = "Cases Trend (Last 6 Weeks)",
                                header = function(value) {
                                    value = paste0("Weekly Case Counts ", rates_timeframe)
                                    div(value)
                                  },
                               align = 'center',
                               html = TRUE,
                               minWidth = 160,
                               cell = function(values, index) {
                                 chart_path = temp_file_dict[cases_reactable_table$Borough[index]]
                                 img_src <- knitr::image_uri(chart_path)
                                 image <- img(src = img_src, alt = '', width = 120, height = 25)
                                 tagList(
                                 div(style = list(display = 'flex'), image))
            })
          ))


```
<center>

##### *Rates based on <20 observations are statistically unreliable and should be used with caution. 
##### **Rates based on <6 observations are not reported.
##### Alert levels are based on case report date. The case rates in the Kusilvak and Bethel Census Areas are artificially elevated this past week due to processing of delayed reports.


<p>&nbsp;</p>
<p>&nbsp;</p>





### COVID-19 and Hospital Capacity

* Hospital capacity remains limited. Large numbers of patients overall (not necessarily with COVID-19 or other respiratory viruses) relative to the number of available staff continue to create capacity challenges across the state, with some areas more affected than others.

* Patient Care Strategies for Scare Resource Situations are currently not being utilized by any facility in Alaska. However, given the continued limited capacity of some facilities, the Crisis Care Committee continues to meet to monitor the situation and remains available to assist facilities and DHSS should the need arise.

* As of March 14, 2022, there were 38 persons with COVID-19 in Alaska hospitals, accounting for 3.1% of all hospitalized persons. Visit the Hospital Dashboard for more data.

<p>&nbsp;</p>
<p>&nbsp;</p>


```{r, Hospital Capacity Over Time Graph, Include = TRUE, Echo = FALSE}
```


<p>&nbsp;</p>
<p>&nbsp;</p>






### COVID-19 and Vaccination
* 71.2% of Alaska residents aged ≥5 years have received at least one dose of a COVID-19 vaccine. Among those who completed the primary vaccine series, 50.2% of Alaska residents ≥18 years have received their booster. Learn more about COVID-19 vaccination coverage in Alaska on the Vaccine Dashboard. Learn more about COVID-19 vaccines.

* Vaccines help protect against infection and against severe disease, especially when a person is up to date on vaccinations. During the 4-week period from February 6, 2022–March 5, 2022, unvaccinated Alaskans were 7.3 times more likely to be hospitalized due to COVID-19 than Alaskans who are up to date on COVID-19 vaccination (i.e., completed the primary series and received a booster dose, if eligible) and 2.9 times more likely to be hospitalized due to COVID-19 than Alaskans who completed the primary vaccination series but are not up to date. These estimates are lagged by one week to partially account for the time it takes to document hospitalizations. (See the monthly report for more data and analysis through January.)




<p>&nbsp;</p>

```{r, Vaccination Vs Unvaccinated Bar Charts Last 6 Weeks, Include = TRUE, Echo = FALSE}
```

##### Unvaccinated Alaskans are 7.3 times more likely to be hospitalized due to COVID-19 than Alaskans who are up to date on COVID-19 vaccination and 2.9 times more likely to be hospitalized due to COVID-19 than Alaskans who completed the primary vaccination series but are not up to date. In order to more easily identify changes over time, the definition of “up to date” as of January 8, 2022, was applied to data from all time points. The absolute rates of hospitalization especially in the most recent 4-week period highlighted in grey are likely underestimates because of COVID-19 hospitalizations that have not yet been documented. **Especially when rates are very low, the estimates of fold-differences between rates may be imprecise. Fold-differences are not calculated if one of the rates is based on <6 cases.

<p>&nbsp;</p>


* Among Alaska residents aged ≥5 years from January 16, 2021–March 12, 2022, 69,054 cases were documented in persons who had completed the primary series and were considered fully vaccinated. Among those vaccine-breakthrough cases, 515 hospitalizations and 180 deaths due to COVID-19 have been recorded. During that time, 98,276 cases have been documented in unvaccinated Alaskans aged ≥5 years, leading to 1,836 hospitalizations and 642 deaths. All data are preliminary and subject to change.

* During the Omicron wave, the incidence of COVID-19 cases in vaccinated persons has become more similar to the incidence in unvaccinated persons. This trend likely reflects multiple factors which may include: immunity wanes over time, cases in vaccinated persons may be more likely to be detected than cases in unvaccinated persons, and there may be increased infection-induced immunity especially among unvaccinated persons.




<p>&nbsp;</p>

```{r, Vaccination Vs Unvaccinated Line Chart Last 38 Weeks, Include = TRUE, Echo = FALSE}
```

##### In order to more easily identify changes over time, the definition of “up to date” as of January 8, 2022 was applied to data from all time points. Some COVID-19 cases with specimen collection in the immediate past week (indicated by the grey box) may have not yet been reported or counted.

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>



## Influenza (“Flu”)
* Reported influenza cases began increasing in Alaska in mid-December. The number of reported cases the week of March 27–April 2 remained similar to the number reported the previous week.

* Right now, most influenza in Alaska is caused by influenza A.
24% of Alaskans aged ≥10 years have been vaccinated against seasonal influenza. It is not too late to get vaccinated against influenza.


* Learn more in the weekly Alaska Influenza Snapshot.

<p>&nbsp;</p>

<center>![Alt text](/Users/ccross/Documents/Projects/COVID-19 Weekly Report R Markdown/6_original.png)<center>

##### Positive influenza lab reports in Alaska by week of specimen collection for the 2017-2018 influenza season through present. The current season through April 2, 2022 is shown in red.

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


## Emergency Department Visits
### Visits with COVID-like or Influenza-like Illness {.unlisted .unnumbered}

* Syndromic surveillance consists of analyzing data on symptoms and diagnoses among patients visiting emergency departments in Alaska. The main goal is to identify trends. Unlike case-based surveillance, syndromic surveillance does not depend on laboratory testing.

* Influenza-like illness (ILI) is defined as having a fever and at least one other symptom, such cough or sore throat. Patients with a diagnosis of influenza are also included, regardless of symptoms.

* COVID-like illness (CLI) encompasses a broader array of respiratory and other symptoms than influenza-like illness. This category also includes any patient with a diagnosis of COVID-19, regardless of symptoms.

* Patients with a diagnosis of COVID-19 are excluded from the ILI category and, likewise, patients with a diagnosis of influenza are excluded from the CLI category. But a patient without a diagnosis for either could be included in both the CLI and ILI categories. CLI and ILI may be caused by respiratory viruses other than SARS-CoV-2 and influenza virus.

* As the Delta variant wave waned in Alaska in late October and November 2021, the percentage of emergency department patients with CLI declined. However, it increased in mid-December, reaching its peak in mid-January. Now, it is at a level lower than that observed in December before the Omicron wave. The percentage of emergency department patients with CLI the week of March 27–April 2 remained similar to the percentage recorded the prior week.

* ILI levels increased in December but have since decreased from the late-December peak, remaining steady over the last few weeks.

<p>&nbsp;</p>
<center>![Alt text](/Users/ccross/Documents/Projects/COVID-19 Weekly Report R Markdown/7_original.jpg)<center>



<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>




## New Updates
### Updates to protect yourself and your family {.unlisted .unnumbered}

* Vaccine boosters: Everyone 12 or older should get a COVID-19 vaccine booster if it's been five months since receiving the Pfizer or Moderna vaccines or two months since receiving the Johnson & Johnson vaccine. People over the age of 50 and some immunocompromised individuals may receive a second mRNA booster (Pfizer or Moderna) four months after their first booster dose. Additionally, people who have received the Johnson & Johnson vaccine for both their primary dose and booster dose may receive a second booster dose using an mRNA vaccine. Pfizer or Moderna vaccine boosters are preferred. Individuals aged 12-17 can receive a Pfizer booster only.

* DHSS Community Case Rates: To complement the CDC’s Community Levels tool, DHSS has introduced a new Community Case Rates tool. Both tools can help individuals, organizations, and communities make decisions about prevention measures. The Alert Levels on the dashboard have been retired and replaced by Community Case Rates.

* Ask a health care provider about treatment: If you test positive and you’re at increased risk for severe COVID, ask a health care provider about treatment options. Treatments can reduce the risk of hospitalization and they work best when given soon after symptoms start. Learn more about COVID-19 treatments and where you can find COVID-19 treatments.

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>






## Information and Resources

* The State of Alaska COVID-19 vaccines update page

* The State of Alaska COVID-19 information page provides more information about the virus and how individuals and businesses can protect themselves and others from transmission. 

* The DHSS Business and Employer Toolkits page has communications resources for any organization that wants to keep workers, partners, clients, and customers informed about COVID-19.

* DHSS COVID-19 Communication Toolkit provides PSAs, flyers, and social media graphics.
** Learn more about the importance of physical activity, highlighted by our Play Every Day and our Healthy You 2022 campaigns: Play Every Day.

* Subscribe to the DHSS Insights blog for behind-the-scenes news about Alaska’s COVID-19 response and other efforts to protect the health and well-being of Alaskans.

* DHSS offers free presentations upon request to groups about COVID-19, the vaccines, COVID-19 prevention, or other health topics upon request. Learn more or request a presentation on our Speaker’s Bureau web page.

* For the most up-to-date case information, see the Alaska COVID-19 Information Hub dashboard: data.coronavirus.alaska.gov. All dashboard data are updated Wednesdays (except holidays). 

* For DHSS media inquiries, please contact clinton.bennett@alaska.gov

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>



```{r tags fonts, include = FALSE}
tags$link(href = "https://fonts.googleapis.com/css?family=Karla:400,700|Fira+Mono&display=fallback", rel = "stylesheet")

tags$link(href = "https://fonts.googleapis.com/css2?family=Open+Sans+Condensed&display=swap", rel="stylesheet")

tags$link(href = "https://fonts.googleapis.com/css2?family=Open+Sans&display=swap", rel="stylesheet")

tags$link(href = "https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap", rel="stylesheet")

tags$link(href = "https://fonts.googleapis.com/css2?family=Varela+Round&display=swap", rel="stylesheet")
```



<style type="text/css">

h1.title {
  font-size: 20px;
  font-family: "Open Sans";
  font-weight: 600;
  color: Black;
  text-align: center;
}

h4.author { /* Header 4 - and the author and data headers use this too  */
  font-size: 24px;
  font-family: "Open Sans";
  font-weight: 700;
  color: Black;
  text-align: center;
  padding-top: 10px
}

h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 20px;
  font-family: "Open Sans";
  font-weight: 600;
  color: Black;
  text-align: center;
  padding-top:20px
}

h2 { /* Section Headers  */
  font-size: 24px;
  font-weight: 600;
  font-family: "Arial";
  color: Black;
}

h3 { /* Sub Headers  */
  font-size: 18px;
  font-weight: 600;
  font-family: "Arial";
  color: Black;
}

h5 { /* Caption  */
  font-size: 11px;
  font-weight: 300;
  font-style: italic;
  font-family: "Arial";
  color: Black;
  text-align: left;
  width:80%
}


body{
  font-family: Arial;
  font-size: 12pt;
}

.area_sans {
  font-family: "Open Sans", sans-seriff;
  display: inline-block;
  font-weight: 800;
  font-size: 16px;
  color: #454545
}

.area_varela {
  font-family: "Varela Round", sans-serif;
  display: inline-block;
  font-weight: 600;
  font-size: 14px;
  color: #454545
}

.area_robo {
  font-family: "Roboto+Slab", serif;
  display: inline-block;
  font-weight: 520;
  font-size: 14px;
  color: #424242
}

.area_fira {
  font-family: "Fira Mono", Consolas, Monaco, monospace;
  display: inline-block;
  font-weight: 800;
  font-size: 12px
}

.number_sans {
  font-family: "Open Sans", sans-seriff;
  display: inline-block;
  padding: 2px 12px;
  border-radius: 15px;
  font-weight: 550;
  font-size: 13px;
  color: #3b3b3b
}

.number_varela {
  font-family: "Varela Round", sans-serif;
  display: inline-block;
  padding: 2px 12px;
  border-radius: 15px;
  font-weight: 600;
  font-size: 14px;
  color: #3b3b3b
}


.number_fira {
  font-family: "Fira Mono", Consolas, Monaco, monospace;
  display: inline-block;
  padding: 2px 12px;
  border-radius: 15px;
  font-weight: 300;
  font-size: 12px;
}

.number_robo {
  font-family: "Roboto+Slab", seriff;
  display: inline-block;
  padding: 2px 12px;
  border-radius: 15px;
  font-weight: 300;
  font-size: 12px;
}

.tag {
  font-family: "Fira Mono", Consolas, Monaco, monospace;
  display: inline-block;
  padding: 2px 12px;
  border-radius: 15px;
  font-weight: 600;
  font-size: 12px;
}
.rate_level_5 {
  background: #a8171c;
  color: #ffffff;
}
.rate_level_4 {
  background: #df342d;
  color: #ffffff;
}
.rate_level_3 {
  background: #fb6f50;
  color: #ffffff;
}
.rate_level_2 {
  background: #fcb194;
  color: #474747;
}
.rate_level_1 {
  background: #fee6da;
  color: #474747;
}

</style>